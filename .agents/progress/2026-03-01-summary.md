# Progress: 1 Mar 2026 — Session Summary

**Plan**: No formal plan — continuation from 27 Feb session
**Date**: 2026-03-01
**Status**: Complete

## Completed

- [x] Feature branch `feat/mobile-google-auth` merged to `main` and pushed (27 Feb)
- [x] Coolify build failure fixed — missing `salt` param in JWT encode (`d3cf23d`)
- [x] Docs sweep — CLAUDE.md, README.md, MEMORY.md all updated (27 Feb)
- [x] Privacy policy account deletion section added (27 Feb)
- [x] iOS CI/CD pipeline added — Fastlane + GitHub Actions workflow for TestFlight (`10c38ca` → `501a002`)
- [x] Progress documentation updated

## Recent Commits on Main (since last progress file)

| Commit | Description |
|--------|-------------|
| `10c38ca` | ci: add Fastlane configuration for iOS builds (Gemfile, Appfile, Fastfile) |
| `e354d96` | ci: add iOS build & TestFlight upload workflow (GitHub Actions) |
| `f1708df` | fix: use Node.js 22 for Capacitor CLI compatibility |
| `501a002` | fix: improve iOS build workflow with ASC API signing |

## iOS CI/CD Infrastructure (New)

### Files Added
- **`.github/workflows/build-ios.yml`** — GitHub Actions workflow: manual dispatch, builds on `macos-14`, Node 22, Capacitor sync, Xcode build with automatic signing, IPA export, TestFlight upload via ASC API key
- **`Gemfile`** — Ruby dependencies (fastlane gem)
- **`fastlane/Appfile`** — App identifier `com.tertiaryinfotech.hrportal`, Apple ID, Team ID `GU9WTSTX9M`
- **`fastlane/Fastfile`** — Two lanes: `beta` (ASC API key + match) and `upload_with_appleid` (Apple ID fallback)

### Required GitHub Secrets
- `APPLE_ID` — Apple Developer account email
- `APPLE_TEAM_ID` — Team ID (hardcoded default: `GU9WTSTX9M`)
- `APPLE_APP_SPECIFIC_PASSWORD` — For Fastlane auth
- `ASC_KEY_ID` — App Store Connect API key ID
- `ASC_ISSUER_ID` — App Store Connect issuer ID
- `ASC_KEY_CONTENT` — Base64-encoded .p8 key file

## Remaining

- [ ] Run `TEST_ENV=production npx playwright test` to validate production
- [ ] Run `npm run test` for unit tests
- [ ] Configure GitHub Secrets for iOS CI/CD workflow
- [ ] Test iOS build workflow via `workflow_dispatch`

### Blocked on Boss
- [ ] Google OAuth Client IDs for Android/iOS (SHA-1 and Bundle ID)
- [ ] UploadThing token (file upload activation)
- [ ] Resend API key (email notifications)
- [ ] Chat widget API key
- [ ] Apple Developer Program enrollment confirmation + ASC API key generation

### Low Priority
- [ ] Fix `isAdmin` inconsistency across files
- [ ] Manual-test DatePicker on desktop and mobile
- [ ] Fill out Data Safety Form in Google Play Console
- [ ] Clean up old branches (`dev`, `feat/mobile-google-auth`)

## Findings

- **iOS CI/CD added outside Claude sessions**: 4 commits (`10c38ca` → `501a002`) added Fastlane and GitHub Actions for iOS builds — likely done manually or via another tool
- **Two Fastlane lanes available**: `beta` (preferred, uses ASC API key for automated signing) and `upload_with_appleid` (fallback)
- **GitHub Actions workflow is manual-dispatch only** (`workflow_dispatch`) — won't auto-trigger on push
- **Node 22 required**: Capacitor CLI needs Node.js 22 (fixed in `f1708df`)

## Blockers (if any)

- iOS build workflow cannot be tested until GitHub Secrets are configured (Apple Developer credentials)
- Native mobile Google Sign-In untestable without platform-specific OAuth Client IDs

## Next Session Should

1. Verify Coolify deploy is healthy at https://hrms.tertiaryinfo.tech
2. Run `TEST_ENV=production npx playwright test` to validate production
3. Run `npm run test` for unit tests
4. If boss has Apple Developer credentials → configure GitHub Secrets and test iOS workflow
5. If boss provides Google OAuth Client IDs → test native mobile sign-in
6. Consider updating CLAUDE.md with iOS CI/CD info (Fastlane, GitHub Actions workflow)
7. Clean up stale branches if no longer needed

## Files Changed (This Session)

- `.agents/progress/2026-03-01-summary.md` — This progress file (new)
