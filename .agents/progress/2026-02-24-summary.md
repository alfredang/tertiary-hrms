# Summary: 24 Feb 2026

**Status**: All executed and deployed (in `c0188a0` on main)

## Plans Executed

### Calendar Event Edit/Delete
- Full CRUD for calendar events. PATCH/DELETE API with ownership enforcement (`createdById`).
- `CalendarEventCard` component with inline Edit/Delete, `/calendar/edit/[id]` page.
- Legacy events with null `createdById` show no action buttons.

### Leave & Expense Edit/Cancel/Reset
- Staff can edit/cancel own PENDING records (with leave balance delta recalculation).
- Admin can reset APPROVED/REJECTED → PENDING with mandatory reason logged to AuditLog.
- Records never deleted (MOM/IRAS audit compliance). All balance ops use `$transaction`.

### Leave Overlap Prevention
- Server-side overlap detection via `getLeaveConflictDates()` in both POST and PATCH endpoints.
- Two half-day leaves on same day allowed (0.5 + 0.5 = 1.0). Only PENDING/APPROVED count.

### UI Polish & Bug Fixes (11 issues)
- Textarea focus-loss bug fixed (sub-components → render functions).
- CANCELLED added to ExpenseStatus enum, amber badges standardized.
- Admin default filter → "All", cancelled items hidden from All tab.
- Reject confirmation with optional reason, simplified calendar edit navigation.

### Column Sorting
- Clickable column headers on leave (default: startDate asc) and expense (default: createdAt desc) tables.
- Chevron indicators, render functions to avoid focus-loss bug.

### E2E Tests for New Features
- 3 new test files (08-10): calendar CRUD, leave actions, expense actions — 11 tests total.
- 8/11 passed; 3 expense tests blocked by production server crash.

### Filter & Action Tweaks
- Admin default "All" filter, hide cancelled from All tab, remove Approve button when reject textarea open.

## Progress Notes
- 10 sessions of work committed in batches.
- Key debugging patterns documented: `router.push()` on div fails silently, `<Link><Button>` hydration mismatch, React sub-component remounting.
